# Пошаговая инструкция по установке и запуску системы анализа звонков

Данная инструкция поможет вам настроить и запустить систему анализа звонков продажников с нуля.

## Предварительные требования

Для работы системы вам понадобятся:

1. **Python 3.8 или выше**
2. **FFmpeg** - для обработки аудиофайлов
3. **API ключи**:
   - **OpenAI API Key** - для Whisper API (транскрипция аудио)
   - **Anthropic API Key** - для Claude API (анализ текста)

## Шаг 1: Клонирование репозитория

```bash
# Создайте директорию для проекта
mkdir sales-call-analyzer
cd sales-call-analyzer

# Скопируйте файлы проекта
# ...
```

## Шаг 2: Создание виртуального окружения Python

```bash
# Создание виртуального окружения
python -m venv venv

# Активация виртуального окружения
# Для Windows:
venv\Scripts\activate
# Для Linux/Mac:
source venv/bin/activate
```

## Шаг 3: Установка зависимостей

```bash
# Установка всех необходимых зависимостей
pip install -r requirements.txt
```

## Шаг 4: Установка FFmpeg

### Windows:
1. Скачайте FFmpeg с [официального сайта](https://ffmpeg.org/download.html)
2. Распакуйте архив в удобное место (например, `C:\ffmpeg`)
3. Добавьте путь к папке `bin` в переменную среды PATH
   - Правой кнопкой на "Этот компьютер" > Свойства > Дополнительные параметры системы > Переменные среды
   - Найдите переменную PATH в разделе "Системные переменные", выберите "Изменить"
   - Добавьте путь к папке bin (например, `C:\ffmpeg\bin`)
   - Нажмите OK, чтобы сохранить изменения

### Linux:
```bash
sudo apt update
sudo apt install ffmpeg
```

### macOS:
```bash
brew install ffmpeg
```

## Шаг 5: Настройка переменных окружения

Создайте файл `.env` в корневой директории проекта и добавьте следующие строки:

```
# API ключи
OPENAI_API_KEY=ваш_ключ_openai
ANTHROPIC_API_KEY=ваш_ключ_anthropic

# Настройки приложения
APP_ENV=development
APP_HOST=0.0.0.0
APP_PORT=8000

# Пути хранения
UPLOAD_DIR=app/static/uploads
RESULTS_DIR=app/static/results
```

## Шаг 6: Запуск скрипта настройки

```bash
python setup.py
```

Данный скрипт создаст необходимые директории и проверит правильность настройки окружения.

## Шаг 7: Тестирование компонентов

```bash
# Тестирование всех компонентов
python test_components.py --all

# Или тестирование отдельных компонентов
python test_components.py --whisper --anthropic
```

## Шаг 8: Запуск приложения

```bash
python run.py
```

После запуска приложение будет доступно по адресу http://localhost:8000

## Шаг 9: Использование системы

1. Откройте веб-браузер и перейдите по адресу http://localhost:8000
2. Используйте форму загрузки для добавления звонков
3. Дождитесь завершения анализа
4. Просмотрите результаты в интерфейсе

## Решение проблем

### Проблема: Ошибка при транскрипции аудио

**Возможные причины и решения**:
- Неверный API ключ OpenAI: проверьте ключ в файле `.env`
- Неподдерживаемый формат аудио: используйте MP3, WAV или M4A
- Ошибка FFmpeg: убедитесь, что FFmpeg правильно установлен

### Проблема: Ошибка при анализе текста

**Возможные причины и решения**:
- Неверный API ключ Anthropic: проверьте ключ в файле `.env`
- Пустая транскрипция: проверьте качество аудиозаписи

### Проблема: Приложение не запускается

**Возможные причины и решения**:
- Порт 8000 занят: измените порт в файле `.env`
- Отсутствуют зависимости: выполните `pip install -r requirements.txt`

## Дополнительная информация

- Логи приложения доступны в консоли, из которой запущено приложение
- Результаты анализа сохраняются в директории `app/static/results`
- Для остановки приложения нажмите `Ctrl+C` в консоли